<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <title>The Flowers Are Still Standing</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="" />
        <meta name="author" content="Jonathan Pearlin" />
        <meta name="keywords" content="" />
        <meta name="generator" content="JBake" />

        <!-- Le styles -->
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
        <link href="/blog/css/asciidoctor.css" rel="stylesheet">
        <link href="/blog/css/base.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link href='http://fonts.googleapis.com/css?family=Droid+Sans' rel='stylesheet' type='text/css'>
		<link href='/blog/css/octicons.min.css' rel='stylesheet' type='text/css'>

        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
              <script src="/blog/js/html5shiv.js"></script>
        <![endif]-->

        <!-- Fav and touch icons -->
        <!--
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png" />
        -->
        <link rel="shortcut icon" href="/blog/favicon.ico" />
    </head>
    <body>
        <div id="wrap">
            <!-- Fixed navbar -->
            <div class="navbar navbar-default navbar-fixed-top" role="navigation">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/blog/index.html">Jonathan Pearlin's Blog</a>
                    </div>
                    <div class="navbar-collapse collapse">
                        <ul class="nav navbar-nav">
                            <li><a href="/blog/about.html">About</a></li>
                            <li><a href="/blog/resume.html">Résumé</a></li>
                            <li><a href="/blog/friends.html">Friends</a></li>
                            <li class="dropdown">
                                <a data-toggle="dropdown" href="#">Tags<b class="caret"></b></a>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a href="/blog/tags/gradle.html">Gradle</a></li>
                                    <li><a href="/blog/tags/grails.html">Grails</a></li>
                                    <li><a href="/blog/tags/groovy.html">Groovy</a></li>
                                    <li><a href="/blog/tags/java.html">Java</a></li>
                                    <li><a href="/blog/tags/maven.html">Maven</a></li>
                                    <li><a href="/blog/tags/spring.html">Spring</a></li>
                                    <li><a href="/blog/tags/zookeeper.html">ZooKeeper</a></li>
                                </ul>
                            </li>
                            <li><a href="/blog/feed.xml">Feed</a></li>
                        </ul>
                        <ul class="nav navbar-nav navbar-right">
                            <li><a href="https://github.com/jdpgrailsdev" target="_blank"><i class="fa fa-github"></i></a></li>
                            <li><a href="http://www.linkedin.com/pub/jonathan-pearlin/4/946/9a0" style="text-decoration:none;" target="_blank"><i class="fa fa-linkedin-square"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
			<div id="activity" class="pull-left">
	            <div class="panel panel-primary">
	                  <!-- Default panel contents -->
	                  <div class="panel-heading"><a target="_blank" href="http://github.com/jdpgrailsdev?tab=activity"><i class="fa fa-github"></i> My Recent GitHub Activity</a></div>
					  <div class="panel-body">
					      <i class='icon-spinner icon-spin icon-large'></i> Loading...
					  </div>
	                  <!-- List group -->
                      <ul class="list-group">
	                  </ul>
	            </div>
			</div>
            <div class="container">
                <div class="page-header">
                    <h1>The Flowers Are Still Standing</h1>
                </div>

                   <a href="/blog/2014/05/06/github_activity_menu.html"><h1>Add a custom GitHub activity stream to your blog</h1></a>
                   <p>06 May 2014</p>
                <p><em>Tags: </em>
                <a href="/blog/tags/github.html">github</a>
        
                <a href="/blog/tags/jquery.html">jquery</a>
        
                <a href="/blog/tags/bootstrap.html">bootstrap</a>
        
                <a href="/blog/tags/blog.html">blog</a>
        </p>

                <div class="g-plusone" data-size="medium" data-href="http://jdpgrailsdev.github.io/blog/2014/05/06/github_activity_menu.html"></div>
                <script type="IN/Share" data-url="http://jdpgrailsdev.github.io/blog/2014/05/06/github_activity_menu.html" data-counter="right"></script>
                <div class="fb-like" data-href="http://jdpgrailsdev.github.io/blog/2014/05/06/github_activity_menu.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

                   <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In an effort to improve my (limited) front-end foo, I decided that I wanted to add a <a href="http://github.com" target="_blank">GitHub</a> activity stream to this blog.  I figured that it would
not be difficult to combine <a href="http://jquery.com" target="_blank">jQuery</a>, <a href="http://getbootstrap.com" target="_blank">Bootstrap</a> and the <a href="https://developer.github.com/v3/" target="_blank">GitHub API</a> to add a widget that would look like a simplified version that you can see
on your own <a href="http://github.com" target="_blank">GitHub</a> page under the <a href="https://github.com/jdpgrailsdev?tab=activity" target="_blank">Public Activity</a> tab on your account.  What follows
is a recounting of how I added the widget that you now see to the left of this article.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ingredients">Ingredients</h3>
<div class="paragraph">
<p>Let&#8217;s start by first listing the specific pieces that I used to create the widget:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://jquery.com" target="_blank">jQuery 1.11.0</a></p>
</li>
<li>
<p><a href="http://getbootstrap.com/components/#panels-list-group" target="_blank">Bootstrap 3.1.1 Panels</a></p>
</li>
<li>
<p><a href="http://fortawesome.github.io/Font-Awesome/" target="_blank">Font Awesome 4.0.3</a></p>
</li>
<li>
<p><a href="https://developer.github.com/v3/activity/events" target="_blank">GitHub Events API</a></p>
</li>
<li>
<p><a href="https://github.com/styleguide/css/7.0" target="_blank">GitHub Octicon</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>My thought process was to use <a href="http://jquery.com" target="_blank">jQuery</a> to perform an AJAX call to the <a href="https://developer.github.com/v3/activity/events" target="_blank">GitHub Events API</a> to get the activity list for my
account.  Upon retrieval, I would append line items to the <a href="http://getbootstrap.com/components/#panels-list-group">Bootstrap 3.1.1 list group panel</a> that I had placed on the left-hand side
of every page on my site.  Finally, I wanted to make use of the <a href="https://github.com/styleguide/css/7.0" target="_blank">GitHub Octicon</a> icon fonts to make have the same icon indicators
that appear on the activity page on my <a href="http://github.com" target="_blank">GitHub</a> account.  Once I had this plan sketched out, the next step was to see about getting the pieces implemented.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pretending_to_be_a_front_end_developer">Pretending to be a front-end developer</h3>
<div class="paragraph">
<p>The first thing that I did was add the example <a href="http://getbootstrap.com/components/#panels-list-group">Bootstrap list group panel</a> to my <code>menu</code> template just to see how it would fit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint html language-html"><code>&lt;div class="panel panel-default"&gt;
  &lt;!-- Default panel contents --&gt;
  &lt;div class="panel-heading"&gt;Panel heading&lt;/div&gt;
  &lt;div class="panel-body"&gt;
    &lt;p&gt;...&lt;/p&gt;
  &lt;/div&gt;

  &lt;!-- List group --&gt;
  &lt;ul class="list-group"&gt;
    &lt;li class="list-group-item"&gt;Cras justo odio&lt;/li&gt;
    &lt;li class="list-group-item"&gt;Dapibus ac facilisis in&lt;/li&gt;
    &lt;li class="list-group-item"&gt;Morbi leo risus&lt;/li&gt;
    &lt;li class="list-group-item"&gt;Porta ac consectetur ac&lt;/li&gt;
    &lt;li class="list-group-item"&gt;Vestibulum at eros&lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Right away, I noticed a bunch of formatting issues, mostly related to positioning the panel relative to the menu at the top of the page and the content in the middle of the page.  I quickly
solved the positioning issue by surrounding the panel with a new <code>&lt;div&gt;</code> element and making use of the <a href="http://getbootstrap.com" target="_blank">Bootstrap</a> <code>pull-left</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint html language-html"><code>&lt;div id="activity" class="pull-left"&gt;
    &lt;div class="panel panel-default"&gt;
      &lt;!-- Default panel contents --&gt;
      &lt;div class="panel-heading"&gt;Panel heading&lt;/div&gt;
      &lt;div class="panel-body"&gt;
        &lt;p&gt;...&lt;/p&gt;
      &lt;/div&gt;

      &lt;!-- List group --&gt;
      &lt;ul class="list-group"&gt;
        &lt;li class="list-group-item"&gt;Cras justo odio&lt;/li&gt;
        &lt;li class="list-group-item"&gt;Dapibus ac facilisis in&lt;/li&gt;
        &lt;li class="list-group-item"&gt;Morbi leo risus&lt;/li&gt;
        &lt;li class="list-group-item"&gt;Porta ac consectetur ac&lt;/li&gt;
        &lt;li class="list-group-item"&gt;Vestibulum at eros&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step was to get the panel to not overlap the menu and to get it to hover a bit off from the left-hand edge of the screen.  To accomplish this, I added a new CSS selector for the
newly added <code>activity</code> ID:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint css language-css"><code>#activity {
  padding-top: 110px;
  padding-left: 20px;
  width: 275px;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>I also decided to use the <code>panel-primary</code> <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>-provided style class to get the widget to be blue, closely matching <a href="http://github.com" target="_blank">GitHub</a>'s color scheme:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint html language-html"><code>&lt;div id="activity" class="pull-left"&gt;
    &lt;div class="panel panel-primary"&gt;
        ...
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It was now time to get rid of the sample content from the example.  My first thought was to start with a spinner to indicate that the panel is attempting to load (as I was going
to use AJAX to get the data) and an empty, unordered list that would be filled by the retrieved data.  I did some searching on the internets and found that <a href="http://getbootstrap.com" target="_blank">Bootstrap</a> has built-in
support for a loading spinner.  With one more line of HTML, I had something that I could work with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint html language-html"><code>&lt;div id="activity" class="pull-left"&gt;
    &lt;div class="panel panel-primary"&gt;
          &lt;!-- Default panel contents --&gt;
          &lt;div class="panel-heading"&gt;
              &lt;a target="_blank" href="http://github.com/jdpgrailsdev?tab=activity"&gt;&lt;i class="fa fa-github"&gt;&lt;/i&gt; My Recent GitHub Activity&lt;/a&gt;
          &lt;/div&gt;
          &lt;div class="panel-body"&gt;
              &lt;i class='icon-spinner icon-spin icon-large'&gt;&lt;/i&gt; Loading...
          &lt;/div&gt;
          &lt;!-- List group --&gt;
          &lt;ul class="list-group"&gt;
          &lt;/ul&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point, I had my target all set up and ready to receive real data from <a href="http://github.com" target="_blank">GitHub</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_time_for_some_javascript">Time for some JavaScript</h3>
<div class="paragraph">
<p>Now that I had a professional (in my opinion) looking widget, I decided to get to work on writing the JavaScript to get the content from <a href="http://github.com" target="_blank">GitHub</a>.  <a href="http://jquery.com" target="_blank">jQuery</a> has a <a href="http://api.jquery.com/ready/" target="_blank">ready</a>
call back method that is fired when the HTML document is loaded.  By combining this with <a href="http://jquery.com" target="_blank">jQuery</a>'s <a href="https://api.jquery.com/jQuery.get/" target="_blank">get</a> method, I could fire off the
request to the <a href="https://developer.github.com/v3/" target="_blank">GitHub API</a> once the DOM has been loaded, ensuring the HTML that I want to replace will be present:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint javascript language-javascript"><code>// Load the GitHub activity widget on the document ready event.
$(document).ready(function() {
    $.get("https://api.github.com/users/jdpgrailsdev/events", function(data) {
        // Remove the "Loading..." place holder.
        $('#wrap &gt; #activity &gt; .panel &gt; .panel-body').remove();

        // Find the activity list from the DOM.
        var activityList = $('#wrap &gt; #activity &gt; .panel &gt; ul');

        // Counter used to determine when we have found the desired number of events for display.
        var count = 0;

        // TODO Handle data returned by GitHub here!

        // If no events were found, display the "No recent activity" message.
        if(count == 0) {
            activityList.append("&lt;li class=\"list-group-item\"&gt;&lt;div&gt;&lt;span class=\"octicon octicon-x\"&gt;&lt;/span&gt;" +
                "&lt;a href=\"https://github.com/jdpgrailsdev?tab=activity\" target=\"_blank\"&gt; No recent activity&lt;/a&gt;&lt;/li&gt;");
        }

        // Add a link to the end of the list to see all of the activity on GitHub.com.
        activityList.append("&lt;li class=\"list-group-item\"&gt;&lt;div&gt;&lt;span class=\"octicon octicon-rss\"&gt;&lt;/span&gt;" +
            "&lt;a href=\"https://github.com/jdpgrailsdev?tab=activity\" target=\"_blank\"&gt; See all activity @ GitHub&lt;/a&gt;&lt;/li&gt;");
    }).fail(function() {
        $('#wrap &gt; #activity &gt; .panel &gt; .panel-body').remove();
        $('#wrap &gt; #activity &gt; .panel &gt; ul').append("&lt;li class=\"list-group-item\"&gt;&lt;span class=\"octicon octicon-alert\"&gt;&lt;/span&gt;GitHub activity could not be retrieved.&lt;/li&gt;");
    });
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code example above makes an AJAX request to <a href="http://github.com" target="_blank">GitHub</a> for my account&#8217;s activity.  If the request is successful, the placeholder text is removed from the view and each event is processed
for display.  If a failure occurs, the <code>fail</code> function is invoked, which prints out a nice error message indicating the failure.  The next step was to actually implement the event handling code.
I only wanted to handle a subset of <a href="https://developer.github.com/v3/activity/events/types/" target="_blank">GitHub Event Types</a> exposed by the <a href="https://developer.github.com/v3/" target="_blank">GitHub API</a>, so I decided to explicitly list out the event types that I was looking for.  Below is the code that handles the data returned
by the <a href="https://developer.github.com/v3/" target="_blank">GitHub API</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint javascript language-javascript"><code>// Loop over each retrieved GitHub event and process.
$.each(data, function(i, githubEvent) {
    // The icon font to be displayed with the event.
    var octicon = "";
    // The hyper link to be applied to the displayed event.
    var link = "";
    // The text to be displayed with the event.
    var text = "";

    // Only show 10 events.  Not all types of GitHub events are implemented here.
    // for the full list, see https://developer.github.com/v3/activity/events/types/
    if(count &lt; 10) {
        if(githubEvent.type == 'CommitCommentEvent') {
            octicon = "octicon-comment";
            link = githubEvent.payload.comment.html_url;
            text = "Commented on " + githubEvent.repo.name + "/commit/" + githubEvent.payload.comment.commit_id;
        } else if(githubEvent.type == 'CreateEvent') {
            octicon = "octicon-repo-create";
            link = "http://github.com/" + githubEvent.repo.name;
            text = "Created repository " + githubEvent.repo.name;
        } else if(githubEvent.type == 'ForkEvent') {
            octicon = "octicon-repo-forked";
            link = githubEvent.payload.forkee.html_url;
            text = "Forked repository " + githubEvent.repo.name;
        } else if(githubEvent.type == 'IssuesEvent') {
            octicon = "octicon-issue-" + githubEvent.payload.action;
            link = githubEvent.payload.issue.html_url;
            text = githubEvent.payload.action.capitalize() + " issue " + githubEvent.repo.name
                + "#" + githubEvent.payload.issue.number;
        } else if(githubEvent.type == 'IssueCommentEvent') {
            octicon = "octicon-comment-discussion";
            link = githubEvent.payload.issue.html_url;
            text = "Commented on " + (githubEvent.payload.issue.pull_request.url != null ? "pull request" : "issue") +
                " " + githubEvent.repo.name + "#" + githubEvent.payload.issue.number;
        } else if(githubEvent.type == 'PullRequestEvent') {
            octicon = 'octicon-git-pull-request';
            link = githubEvent.payload.pull_request.html_url;
            text = githubEvent.payload.action.capitalize() + " pull request " + githubEvent.repo.name
                + "#" + githubEvent.payload.number;
        } else if(githubEvent.type == 'PullRequestReviewCommentEvent') {
            octicon = "octicon-comment";
            link = githubEvent.payload.comment.html_url;
            text = "Commented on pull request " + githubEvent.repo.name + "#"
                + extractPullRequestNumber(githubEvent.payload.comment.pull_request_url);
        } else if(githubEvent.type == 'PushEvent' &amp;&amp; !(githubEvent.repo.name == "jdpgrailsdev/blog")) {
            octicon = "octicon-git-commit";
            link = "http://github.com/" + githubEvent.repo.name + "/commit/" + githubEvent.payload.head;
            text = "Pushed to " + normalizeBranch(githubEvent.payload.ref) + " at " + githubEvent.repo.name;
        }

        // If the event is one of the supported types, add a new line item to the HTML panel.
        if(text) {
            var eventDateHtml = createEventDateHtml(githubEvent.created_at);
            activityList.append("&lt;li id=\"" + githubEvent.id + "\" class=\"list-group-item\"&gt;&lt;div&gt;&lt;span class=\"octicon " +
                octicon + "\"&gt;&lt;/span&gt;&lt;a href=\"" + link + "\" target=\"_blank\"&gt; " + text + "&lt;/a&gt;&lt;/div&gt;" + eventDateHtml + "&lt;/li&gt;");
            count++;
        }
    }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code above sets the icon, link and text for each event found in the response, up to the number of events that I want displayed.  Once the data has been computed for a given event,
it is injected into the HTML as a new list item via the <code>append</code> function on the container list.</p>
</div>
</div>
<div class="sect2">
<h3 id="_octicon">Octicon</h3>
<div class="paragraph">
<p>In order to make the widget look and feel just like the activity stream on <a href="http://github.com" target="_blank">GitHub</a>, I decided that I wanted to use the {github_octicon} font icons.  Unfortunately, the CSS for these font icons
does not appear to be publically available from <a href="http://github.com" target="_blank">GitHub</a>.  Luckily, I came across <a href="https://github.com/rummik/octicon" target="_blank">someone</a>, which is a port of the
{github_octicon} font icons to a CSS file that can be included in your web application.  Armed with the CSS files from this port, I was able to make use of the CSS classes listed in the
{github_octicon} style guide in my widget.  In order to not make a network call out to the <a href="http://github.com" target="_blank">GitHub</a> account that hosts the port, I downloaded these files and included them in my web resources.</p>
</div>
</div>
<div class="sect2">
<h3 id="_final_tweaks">Final tweaks</h3>
<div class="paragraph">
<p>After making the changes outlined so far in this post, I thought that I had a pretty solid solution.  However, as soon as I went to look at my site with different resolutions, I noticed that
the widget was not always being displayed correctly.  I needed to find a way to make sure that the widget always stuck to the left-hand side of the page and did not encroach on the content
displayed to the right of the widget.  After playing around with the CSS, I came up with the following solution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint css language-css"><code>#activity {
  padding-top: 110px;
  padding-left: 20px;
  width: 275px;
}

#wrap &gt; #activity &gt; .panel &gt; ul {
  margin-left: 0px;
}

#wrap &gt; #activity &gt; .panel &gt; .panel-heading &gt; a {
    color: #ffffff;
}

#wrap &gt; .container {
  padding-top: 60px;
  padding-left: 30px;
  display: inline-block;		<i class="conum" data-value="1"></i><b>(1)</b>
  width: 70%;			<i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Displays the DIV inline next to the div that contains the <a href="http://github.com" target="_blank">GitHub</a> widget</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Ensures that some space is left for the widget</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you remember from the beginning of the post, the <a href="http://github.com" target="_blank">GitHub</a> widget applies the <code>pull-left</code> class, which ensures that it is left-aligned on the page.  The trick here is to make sure that
the DIV that contains the main content (the blog posts themselves) is aligned side-by-side with the widget.  From the example above, you can see that it now uses the <code>inline-block</code> display
attribute to achieve this.</p>
</div>
</div>
<div class="sect2">
<h3 id="_summary">Summary</h3>
<div class="paragraph">
<p>I do not claim to be an user interface developer, nor do I play one on TV.  This little side project certainly helped me to get a little bit more familiar with <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>, <a href="http://jquery.com" target="_blank">jQuery</a>,
the <a href="https://developer.github.com/v3/" target="_blank">GitHub API</a>, CSS and icon fonts.  I&#8217;m sure that there are improvements that can be made to both the approach and the code.  Hopefully, I will be able to come back to this widget in the
future as my skills in the area of front-end development grow.</p>
</div>
</div></p>
                <p><a href="/blog/2014/05/06/github_activity_menu.html#disqus_thread">Comments</a></p>
                   <a href="/blog/2014/04/29/gradle_cobertura.html"><h1>Code Coverage with Cobertura</h1></a>
                   <p>29 April 2014</p>
                <p><em>Tags: </em>
                <a href="/blog/tags/gradle.html">gradle</a>
        
                <a href="/blog/tags/cobertura.html">cobertura</a>
        </p>

                <div class="g-plusone" data-size="medium" data-href="http://jdpgrailsdev.github.io/blog/2014/04/29/gradle_cobertura.html"></div>
                <script type="IN/Share" data-url="http://jdpgrailsdev.github.io/blog/2014/04/29/gradle_cobertura.html" data-counter="right"></script>
                <div class="fb-like" data-href="http://jdpgrailsdev.github.io/blog/2014/04/29/gradle_cobertura.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

                   <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In all of my projects, I typically like to include unit tests and unit test coverage analysis to determine the effectiveness of my tests.  While there
are different Java code coverage packages out there, I normally use <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a>, mostly due to ease of use, features and familiarity with it.  In this
post, I am going to cover the different ways to configure and use <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> as part of <a href="http://maven.apache.org/" target="_blank">Maven</a>, <a href="http://grails.org" target="_blank">Grails</a> and <a href="http://gradle.org" target="_blank">Gradle</a> projects.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_maven">Maven</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to perform <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> instrumentation and generate coverage reports in a <a href="http://maven.apache.org/" target="_blank">Maven</a> project, the first thing that you will need to do is to
include the <a href="http://mojo.codehaus.org/cobertura-maven-plugin/" target="_blank">Cobertura Maven Plugin</a> in your project&#8217;s <code>pom.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;plugin&gt;
    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
    &lt;artifactId&gt;cobertura-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.6&lt;/version&gt;
    &lt;configuration&gt;
        &lt;formats&gt;
            &lt;format&gt;html&lt;/format&gt;		<i class="conum" data-value="1"></i><b>(1)</b>
            &lt;format&gt;xml&lt;/format&gt;
        &lt;/formats&gt;
        &lt;outputDirectory&gt;${project.build.directory}/surefire-reports/cobertura&lt;/outputDirectory&gt;		<i class="conum" data-value="2"></i><b>(2)</b>
        &lt;instrumentation&gt;
            &lt;ignoreTrivial&gt;true&lt;/ignoreTrivial&gt;			<i class="conum" data-value="3"></i><b>(3)</b>
            &lt;ignores&gt;
                &lt;ignore&gt;org.slf4j.Logger.*&lt;/ignore&gt;		<i class="conum" data-value="4"></i><b>(4)</b>
            &lt;/ignores&gt;
            &lt;excludes&gt;
                &lt;exclude&gt;**/Example.class&lt;/exclude&gt;		<i class="conum" data-value="5"></i><b>(5)</b>
            &lt;/excludes&gt;
        &lt;/instrumentation&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;phase&gt;package&lt;/phase&gt;			<i class="conum" data-value="6"></i><b>(6)</b>
            &lt;goals&gt;
                &lt;goal&gt;cobertura&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables the output format(s) for the generated coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Sets the output location for the generated coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Instructs <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> to ignore trivial methods, such as getters and setters when producing the coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Instructs <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> to ignore any references to methods of the <code>org.slf4j.Logger</code> class when producing the coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Provides <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> with a list of compiled class files to ignore when producing the coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Binds the <code>cobertura</code> goal of the <a href="http://mojo.codehaus.org/cobertura-maven-plugin/" target="_blank">Cobertura Maven Plugin</a> to the <code>package</code> phase of the <a href="https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Lifecycle_Reference" target="_blank">Maven Build Lifecycle</a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The configuration of the <a href="http://mojo.codehaus.org/cobertura-maven-plugin/" target="_blank">Cobertura Maven Plugin</a> shown above will cause the <code>cobertura</code> goal to execute automatically during the <code>package</code> phase of the
<a href="http://maven.apache.org/" target="_blank">Maven</a> lifecycle.  For instance, if the following command is executed on a <a href="http://maven.apache.org/" target="_blank">Maven</a> project:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>maven clean package</pre>
</div>
</div>
<div class="paragraph">
<p>then the <a href="http://mojo.codehaus.org/cobertura-maven-plugin/" target="_blank">Cobertura Maven Plugin</a> will automatically execute, producing the coverage report(s) specified in the configuration.  Of course, you can always
manually invoke the plugin by running the goal explicitly in the project:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>maven cobertura</pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on the configuration and use of the <a href="http://mojo.codehaus.org/cobertura-maven-plugin/" target="_blank">Cobertura Maven Plugin</a>, consult the <a href="http://mojo.codehaus.org/cobertura-maven-plugin/usage.html" target="_blank">usage</a> and
<a href="http://mojo.codehaus.org/cobertura-maven-plugin/cobertura-mojo.html" target="_blank">cobertura goal</a> documentation.</p>
</div>
<div class="paragraph">
<p>Finally, this all assumes that you have unit tests that will execute as part of the <code>test</code> phase of the <a href="https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Lifecycle_Reference" target="_blank">Maven Build Lifecycle</a>.  Take
a look at the <a href="http://maven.apache.org/surefire/maven-surefire-plugin/" target="_blank">Maven Surefire Plugin</a> for an example of how to execute unit tests as part of a <a href="http://maven.apache.org/" target="_blank">Maven</a> build.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_grails">Grails</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Like with <a href="http://maven.apache.org/" target="_blank">Maven</a>, there is a <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> plugin for the <a href="http://grails.org" target="_blank">Grails</a> framework.  The first step to enabling the generation of <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> code coverage report(s) in a <a href="http://grails.org" target="_blank">Grails</a> project is to
include the <a href="http://grails.org/plugin/code-coverage" target="_blank">Cobertura Grails Plugin</a> as a dependency in your <code>BuildConfig.groovy</code>, <code>pom.xml</code> or <code>build.gradle</code>, depending on which build system your project uses:</p>
</div>
<div class="listingblock">
<div class="title">BuildConfig.groovy</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>plugins {
    test ':code-coverage:1.2.7'		<i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Dependencies in <code>BuildConfig.groovy</code> without a group ID are assumed to have a <code>org.grails</code> or <code>org.grails.plugins</code> as a group ID, depending on which closure they are declared in.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.grails.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;code-coverage&lt;/artifactId&gt;
    &lt;version&gt;1.2.7&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
    &lt;type&gt;zip&lt;/type&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>dependencies {
    test 'org.grails.plugins:code-coverage:1.2.7'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step is to configure the <a href="http://grails.org/plugin/code-coverage" target="_blank">Cobertura Grails Plugin</a>, also in <code>BuildConfig.groovy</code>:</p>
</div>
<div class="listingblock">
<div class="title">BuildConfig.groovy</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>coverage {
    enabledByDefault = true		<i class="conum" data-value="1"></i><b>(1)</b>
    html = true				<i class="conum" data-value="2"></i><b>(2)</b>
    xml = true

    exclusions = ['**/*Example*']	<i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Automatically instruments the code and generates the coverage report(s) when running tests.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Enables the output format(s) for the generated coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Provides <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> with a list of compiled class files to ignore when producing the coverage report(s).</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The configuration of the <a href="http://grails.org/plugin/code-coverage" target="_blank">Cobertura Grails Plugin</a> shown above will cause the the plugin to execute automatically when running the <code>test-app</code> <a href="http://grails.org" target="_blank">Grails</a> command.  For instance,
if the following command is executed on a <a href="http://grails.org" target="_blank">Grails</a> project:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>grails test-app :unit</pre>
</div>
</div>
<div class="paragraph">
<p>then the <a href="http://grails.org/plugin/code-coverage" target="_blank">Cobertura Grails Plugin</a> will automatically execute, producing the coverage report(s) specified in the configuration.  Of course, you can always
manually invoke the plugin by adding an additional parameter to the <code>test-app</code> command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>grails test-app :unit --coverage</pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on the configuration and use of the <a href="http://grails.org/plugin/code-coverage" target="_blank">Cobertura Grails Plugin</a>, consult the <a href="https://github.com/beckje01/grails-code-coverage" target="_blank">Grails Code Coverage plugin</a> documentation.</p>
</div>
<div class="paragraph">
<p>As with the <a href="http://mojo.codehaus.org/cobertura-maven-plugin/" target="_blank">Cobertura Maven Plugin</a>, the code coverage report(s) will only be generated if there are unit tests or source files that can be under test present in the project.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gradle">Gradle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are multiple <a href="http://gradle.org" target="_blank">Gradle</a> plugins that provide <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> functionality to a <a href="http://gradle.org" target="_blank">Gradle</a> project.  The one that I prefer to use is the <a href="https://github.com/stevesaliman/gradle-cobertura-plugin" target="_blank">Cobertura Gradle Plugin</a> that is maintained by Steve Saliman.
This plugin provides much better configuration option and has much better documentation (at the time of writing) than the others.  Below is a sample <a href="http://gradle.org" target="_blank">Gradle</a> project file that includes the
<a href="https://github.com/stevesaliman/gradle-cobertura-plugin" target="_blank">Cobertura Gradle Plugin</a>:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>apply plugin: 'groovy'
apply plugin: 'cobertura'			<i class="conum" data-value="1"></i><b>(1)</b>

group = 'com.example'
version = '1.0.0-SNAPSHOT'
description = """Sample project with Spock tests and Cobertura code coverage"""

sourceCompatibility = 1.7
targetCompatibility = 1.7

buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
    }
    dependencies {
        classpath 'net.saliman:gradle-cobertura-plugin:2.2.4'			<i class="conum" data-value="2"></i><b>(2)</b>
    }
}

repositories {
    mavenLocal()
    mavenCentral()
}

dependencies {
    compile group: 'org.codehaus.groovy', name: 'groovy-all', '2.2.1'

    testCompile group: 'cglib', name: 'cglib-nodeps', version:'2.2.2'
    testCompile group: 'junit', name: 'junit-dep', version:'4.11'
    testCompile group: 'org.spockframework', name: 'spock-core', '0.7-groovy-2.0'
    testCompile group: 'org.objenesis', name: 'objenesis', version:'1.2'
}

test {
    filter {
        includeTestsMatching "*Spec"
    }
}

cobertura {
    coverageFormats = ['html', 'xml']				<i class="conum" data-value="3"></i><b>(3)</b>
    coverageIgnoreTrivial = true					<i class="conum" data-value="4"></i><b>(4)</b>
    coverageIgnores = ['org.slf4j.Logger.*']			<i class="conum" data-value="5"></i><b>(5)</b>
    coverageReportDir = new File("$buildDir/reports/cobertura")	<i class="conum" data-value="6"></i><b>(6)</b>
}

test.finalizedBy(project.tasks.cobertura)			<i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Applies the <a href="https://github.com/stevesaliman/gradle-cobertura-plugin" target="_blank">Cobertura Gradle Plugin</a> to this build script.  This means that the tasks registered by the plugin will be available to be executed by this project.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Tells <a href="http://gradle.org" target="_blank">Gradle</a> to add the JAR that contains the <a href="https://github.com/stevesaliman/gradle-cobertura-plugin" target="_blank">Cobertura Gradle Plugin</a> and its tasks to the classpath for the build script.  This is required for <a href="http://gradle.org" target="_blank">Gradle</a> to be able to find the plugin.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Enables the output format(s) for the generated coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Instructs <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> to ignore trivial methods, such as getters and setters when producing the coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Instructs <a href="http://cobertura.github.io/cobertura/" target="_blank">Cobertura</a> to ignore any references to methods of the <code>org.slf4j.Logger</code> class when producing the coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Sets the output location for the generated coverage report(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Tells <a href="http://gradle.org" target="_blank">Gradle</a> to automatically execute the <code>cobertura</code> task after the <code>test</code> task has completed.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The configuration of the <a href="https://github.com/stevesaliman/gradle-cobertura-plugin" target="_blank">Cobertura Gradle Plugin</a> shown above will cause the the plugin to execute automatically after the <code>test</code> task completes.  For instance,
if the following command is executed on a <a href="http://gradle.org" target="_blank">Gradle</a> project:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./gradlew test</pre>
</div>
</div>
<div class="paragraph">
<p>then the <a href="https://github.com/stevesaliman/gradle-cobertura-plugin" target="_blank">Cobertura Gradle Plugin</a> will automatically execute, producing the coverage report(s) specified in the configuration.  Of course, you can always
manually invoke the plugin by running the <code>cobertura</code> task explicitly:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./gradlew cobertura</pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on the configuration and use of the plugin, consult the documentation on its <a href="https://github.com/stevesaliman/gradle-cobertura-plugin" target="_blank">GitHub repository</a>.</p>
</div>
<div class="paragraph">
<p>As with the <a href="http://mojo.codehaus.org/cobertura-maven-plugin/" target="_blank">Cobertura Maven Plugin</a> and <a href="http://grails.org/plugin/code-coverage" target="_blank">Cobertura Grails Plugin</a>, the code coverage report(s) will only be generated if there are unit tests or source files that can be under test present in the project.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The examples above illustrate how I normally configure the various plugins for use in the different build systems outlined in this post.  Once you have found a configuration that works for you, I would
recommend looking into integration with your build system/continuous integration in order to publish reports and determine the health of a build based on additions or regressions in the amount of code
under test for your project.  That being said, just having the ability to generate code coverage to determine the effectiveness of unit tests is still a step in the right direction towards
ensuring the stability of any code base.</p>
</div>
</div>
</div></p>
                <p><a href="/blog/2014/04/29/gradle_cobertura.html#disqus_thread">Comments</a></p>
                   <a href="/blog/2014/04/22/grails_gradle_logback.html"><h1>The Grails Gradle Plugin and Logback</h1></a>
                   <p>22 April 2014</p>
                <p><em>Tags: </em>
                <a href="/blog/tags/grails.html">grails</a>
        
                <a href="/blog/tags/gradle.html">gradle</a>
        
                <a href="/blog/tags/logback.html">logback</a>
        </p>

                <div class="g-plusone" data-size="medium" data-href="http://jdpgrailsdev.github.io/blog/2014/04/22/grails_gradle_logback.html"></div>
                <script type="IN/Share" data-url="http://jdpgrailsdev.github.io/blog/2014/04/22/grails_gradle_logback.html" data-counter="right"></script>
                <div class="fb-like" data-href="http://jdpgrailsdev.github.io/blog/2014/04/22/grails_gradle_logback.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

                   <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In a <a href="http://jonathanpearlin.com/blog/2014/03/24/grails_logback.html" target="_blank">previous post</a>, I discussed how to switch a <a href="http://grails.org" target="_blank">Grails</a> application to use <a href="http://logback.qos.ch/" target="_blank">Logback</a> instead of Log4j for logging.  In that post, I
covered using both the <a href="http://maven.apache.org/" target="_blank">Maven</a> support in Grails to configure the dependencies required to use <a href="http://logback.qos.ch/" target="_blank">Logback</a> with <a href="http://grails.org" target="_blank">Grails</a>, as well as how to use the built in dependency management support via the
<code>BuildConfig.groovy</code> dependencies DSL.  I did not cover how to make this all work with <a href="http://gradle.org" target="_blank">Gradle</a>.  The same caveats and issues, as mentioned previously, still apply with regards to the <a href="http://logback.qos.ch/" target="_blank">Logback</a> DSL
defined in <code>Config.groovy</code> and the use of the <code>logback.groovy</code> file in its place, so I will not re-hash that here.  Instead, I will point out a couple of issues with regards to getting the
dependencies configured correctly in the <code>build.gradle</code> file.  Similar to the other approaches, you still need to provide global excludes for the Log4J related dependencies:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>configurations {
     all*.exclude group: 'org.grails', module: 'grails-plugin-log4j'		<i class="conum" data-value="1"></i><b>(1)</b>
     all*.exclude group: 'org.slf4j', module: 'slf4j-log4j12'			<i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Exclude the <a href="http://grails.org" target="_blank">Grails</a> Log4J plugin, per the instructions provided by the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Exclude the Log4J SLF4J binding, as <a href="http://logback.qos.ch/" target="_blank">Logback</a> provides its own SLF4J binding.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Next, include the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a> as a dependency:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>dependencies {
    compile ('org.grails.plugins:logback:0.3.1') {
        exclude(module:'slf4j-api')								<i class="conum" data-value="1"></i><b>(1)</b>
    }
    compile ('ch.qos.logback:logback-classic:1.1.1') {						<i class="conum" data-value="2"></i><b>(2)</b>
        exclude(module:'slf4j-api')
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Exclude the SLF4J transitive dependency so that it does not conflict with the version provided by <a href="http://grails.org" target="_blank">Grails</a></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>I added an explicit dependency for <code>logback-classic</code> so that I could use a newer version than the one transitively provided by the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>I thought that this would be enough to build my application&#8217;s WAR file using the <code>grails-war</code> task of the <a href="https://github.com/grails/grails-gradle-plugin/" target="_blank">Grails Gradle Plugin</a>.  However, when I went to execute the task, the
build failed with the following exception:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint"><code>| Error Error generating web.xml file
org.codehaus.groovy.runtime.typehandling.GroovyCastException: Cannot cast object 'org.slf4j.helpers.NOPLoggerFactory@7f4cfb5' with class 'org.slf4j.helpers.NOPLoggerFactory' to class 'ch.qos.logback.classic.LoggerContext'</code></pre>
</div>
</div>
<div class="paragraph">
<p>What is really strange is that this does not happen when using the <code>grails-run-app</code> <a href="http://gradle.org" target="_blank">Gradle</a> task.  Additionally, the following also appears in the output when attempting to build the WAR file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint"><code>SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.</code></pre>
</div>
</div>
<div class="paragraph">
<p>A quick search of the internets for both of these issues indicate that you are either A) do not have any SLF4J binding on your classpath, thus causing SLF$J to default to the no-op binding, or B) have an
SLF4J binding on the classpath in addition to the one provided by <a href="http://logback.qos.ch/" target="_blank">Logback</a>.  Those two statements obviously contradict with each other.  After scratching my head for a while, I realized that the <a href="https://github.com/grails/grails-gradle-plugin/" target="_blank">Grails Gradle Plugin</a>
has a <code>bootstrap</code> dependency scope, which is used to provide dependencies to the <a href="http://grails.org" target="_blank">Grails</a> commands, which themselves are GAnt scripts written in <a href="http://groovy.codehaus.org" target="_blank">Groovy</a>.  These scripts also need a logger to output
the status of what is being executed.  I decided to add a duplicate dependency to the <code>build.gradle</code> build file to see if that would fix the problem:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>dependencies {
    compile ('org.grails.plugins:logback:0.3.1') {
        exclude(module:'slf4j-api')
    }
    compile ('ch.qos.logback:logback-classic:1.1.1') {
        exclude(module:'slf4j-api')
    }
    bootstrap 'ch.qos.logback:logback-classic:1.1.1'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After adding the dependency to the separate <code>bootstrap</code> scope, I once again ran the <code>grails-war</code> <a href="http://gradle.org" target="_blank">Gradle</a> task and got a much better outcome:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint"><code>| Done creating WAR build/distributions/test-1.0.0.war

BUILD SUCCESSFUL

Total time: 17.166 secs</code></pre>
</div>
</div>
<div class="paragraph">
<p>Much better.  It&#8217;s important to remember that the <a href="http://grails.org" target="_blank">Grails</a> build eco-system is itself a Java-based application that requires its own set of dependencies just to execute.  When using the <a href="http://grails.org" target="_blank">Grails</a>
command line arguments or building via <a href="http://maven.apache.org/" target="_blank">Maven</a>, this classpath is management automatically.  However, when using the <a href="https://github.com/grails/grails-gradle-plugin/" target="_blank">Grails Gradle Plugin</a> plugin, you currently have to manage any additions to this yourself
via the <code>bootstrap</code> scope (an interesting side note here is that now <a href="http://grails.org" target="_blank">Grails</a> is using <a href="http://logback.qos.ch/" target="_blank">Logback</a> for all logging, not just when executing the application).</p>
</div>
</div>
</div></p>
                <p><a href="/blog/2014/04/22/grails_gradle_logback.html#disqus_thread">Comments</a></p>
                   <a href="/blog/2014/04/15/gradle_api_dependencies.html"><h1>Gradle API and Transitive Dependencies</h1></a>
                   <p>15 April 2014</p>
                <p><em>Tags: </em>
                <a href="/blog/tags/gradle.html">gradle</a>
        </p>

                <div class="g-plusone" data-size="medium" data-href="http://jdpgrailsdev.github.io/blog/2014/04/15/gradle_api_dependencies.html"></div>
                <script type="IN/Share" data-url="http://jdpgrailsdev.github.io/blog/2014/04/15/gradle_api_dependencies.html" data-counter="right"></script>
                <div class="fb-like" data-href="http://jdpgrailsdev.github.io/blog/2014/04/15/gradle_api_dependencies.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

                   <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Recently, I have been working on porting the <a href="http://raml.org" target="_blank">RAML</a> <a href="http://maven.apache.org/" target="_blank">Maven</a> plugin to a <a href="http://gradle.org" target="_blank">Gradle</a> plugin and ran into a limitation with <a href="http://gradle.org" target="_blank">Gradle</a> and its API jars.  An interesting difference between <a href="http://gradle.org" target="_blank">Gradle</a> and
<a href="http://maven.apache.org/" target="_blank">Maven</a> is that <a href="http://gradle.org" target="_blank">Gradle</a> does not want you to rely on its API jars from a <a href="http://maven.apache.org/" target="_blank">Maven</a> repository (unlike <a href="http://maven.apache.org/" target="_blank">Maven</a>, whose API jars are all stored in the central <a href="http://maven.apache.org/" target="_blank">Maven</a> repository).  Instead, the
<a href="http://gradle.org" target="_blank">Gradle</a> team has built in some special dependency handlers that in effect treat the required <a href="http://gradle.org" target="_blank">Gradle</a> (and <a href="http://groovy.codehaus.org" target="_blank">Groovy</a> dependencies, if need be) as "provided" dependencies:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>...
dependencies {
    gradleApi()						<i class="conum" data-value="1"></i><b>(1)</b>
    localGroovy()					<i class="conum" data-value="2"></i><b>(2)</b>
    compile 'commmons-lang:commons-lang:2.6'
}
...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Tells <a href="http://gradle.org" target="_blank">Gradle</a> to include the gradle-core dependency and its required dependencies.  Normally used for plugin development.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Tells <a href="http://gradle.org" target="_blank">Gradle</a> to include the <a href="http://groovy.codehaus.org" target="_blank">Groovy</a> dependency used by <a href="http://gradle.org" target="_blank">Gradle</a>, which at the time of writing is 1.8.6.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What this means is that when building your <a href="http://gradle.org" target="_blank">Gradle</a> plugin, <a href="http://gradle.org" target="_blank">Gradle</a> will use the jars that are part of the local <a href="http://gradle.org" target="_blank">Gradle</a> installation to resolve these dependencies, thus ensuring that you
get the right versions of jars used by the <a href="http://gradle.org" target="_blank">Gradle</a> API based on the <a href="http://gradle.org" target="_blank">Gradle</a> version.  It will <strong>NOT</strong> resolve these dependencies against any external repository.  This is a nice improvement
over <a href="http://maven.apache.org/" target="_blank">Maven</a>, but it comes with one major limitation that can cause issues:  there is no way to override and/or exclude any of the transitive dependencies brought in by the <a href="http://gradle.org" target="_blank">Gradle</a>.  This
wouldn&#8217;t be that big of an issue, except for the fact the <code>gradleApi()</code> dependency has a bunch of transitive dependencies.  Below is an example of what is include if both <code>gradleApi()</code> and
<code>localGroovy()</code> are used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint text language-text"><code>~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-core-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/groovy-all-1.8.6.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/asm-all-5.0_BETA.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/ant-1.9.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/commons-collections-3.2.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/commons-io-1.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/commons-lang-2.6.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/ivy-2.2.0.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/logback-core-1.0.13.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/logback-classic-1.0.13.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/guava-jdk5-14.0.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/jcip-annotations-1.0.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/jul-to-slf4j-1.7.5.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/jarjar-1.3.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/javax.inject-1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/bintray-client-java-impl-0.1.0.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/httpclient-4.2.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/slf4j-api-1.7.5.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/log4j-over-slf4j-1.7.5.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/jcl-over-slf4j-1.7.5.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/ant-launcher-1.9.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/jsch-0.1.46.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/joda-time-2.3.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/bintray-client-java-api-0.1.0.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/commons-logging-1.1.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/commons-beanutils-1.8.0.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/ezmorph-1.0.6.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/json-lib-2.3-jdk15.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/xml-resolver-1.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/http-builder-0.6.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/commons-codec-1.6.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/httpcore-4.2.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/jcifs-1.3.17.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-docs-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-base-services-groovy-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-base-services-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-resources-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-cli-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-native-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/jna-3.2.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/native-platform-0.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/jna-posix-1.0.3.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/jansi-1.2.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/native-platform-osx-i386-0.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/native-platform-osx-amd64-0.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/native-platform-linux-amd64-0.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/native-platform-linux-i386-0.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/native-platform-windows-amd64-0.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/native-platform-windows-i386-0.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-messaging-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/kryo-2.20.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/asm-4.0.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/reflectasm-1.07-shaded.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/minlog-1.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/objenesis-1.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-core-impl-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-settings-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-repository-metadata-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-plexus-container-default-1.5.5.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-aether-provider-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-wagon-provider-api-2.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-plexus-cipher-1.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-plexus-interpolation-1.14.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-plexus-utils-2.0.6.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-plexus-classworlds-2.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-plugin-api-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-model-builder-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-plexus-sec-dispatcher-1.3.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-plexus-component-annotations-1.5.5.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-aether-connector-wagon-1.13.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-compat-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-wagon-http-2.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-aether-api-1.13.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-settings-builder-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-aether-spi-1.13.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-core-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-wagon-http-shared4-2.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-aether-util-1.13.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-artifact-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-maven-model-3.0.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jarjar-aether-impl-1.13.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/maven-ant-tasks-2.1.3.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/nekohtml-1.9.14.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/xbean-reflect-3.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/xml-apis-1.3.04.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/xercesImpl-2.9.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-tooling-api-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-plugins-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/junit-4.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/testng-6.3.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/commons-cli-1.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/bsh-2.0b4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jcommander-1.12.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/snakeyaml-1.6.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/hamcrest-core-1.3.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-code-quality-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-jetty-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jetty-6.1.25.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jetty-util-6.1.25.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/servlet-api-2.5-20081211.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jetty-plus-6.1.25.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jsp-2.1-6.1.14.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jetty-annotations-6.1.25.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/geronimo-annotation_1.0_spec-1.0.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jetty-naming-6.1.25.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/core-3.1.1.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jsp-api-2.1-6.1.14.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-antlr-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/ant-antlr-1.9.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/antlr-2.7.7.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/gradle-wrapper-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-osgi-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/bndlib-2.1.0.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-maven-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/pmaven-common-0.8-20100325.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/pmaven-groovy-0.8-20100325.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/plexus-component-annotations-1.5.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-ide-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-announce-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-scala-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-sonar-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/sonar-runner-2.0.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/sonar-batch-bootstrapper-2.9.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-signing-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/bcpg-jdk15-1.46.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/bcprov-jdk15-1.46.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-cpp-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-ear-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-javascript-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/rhino-1.7R3.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gson-2.2.4.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/simple-4.1.21.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-build-comparison-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-diagnostics-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-reporting-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/jatl-0.2.2.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-publish-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-ivy-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-jacoco-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-build-init-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-language-jvm-1.11.jar
~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/gradle-language-base-1.11.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you build a plugin and use it in another <a href="http://gradle.org" target="_blank">Gradle</a> project, these dependencies do not appear to override and/or interfere with any dependencies of that project.  Where
this becomes an issues is with the "test" scope of the <a href="http://gradle.org" target="_blank">Gradle</a> plugin project itself.  I first noticed an issue when attempting to use the <a href="http://groovy.codehaus.org" target="_blank">Groovy</a> 2.0 version of <a href="https://code.google.com/p/spock/" target="_blank">Spock</a>
to write tests for my plugin.  Each time I attempted to build the project (and therefore run the tests), <a href="https://code.google.com/p/spock/" target="_blank">Spock</a> would complain that <a href="http://groovy.codehaus.org" target="_blank">Groovy</a> 1.8.6 was not compatible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint text language-text"><code>GroovyVersionException: The Spock compiler plugin cannot execute because Spock 0.7.0-groovy-2.0 is not compatible with Groovy 1.8.6. For more information, see http://versioninfo.spockframework.org
Spock location: file:~/.gradle/caches/artifacts-23/filestore/org.spockframework/spock-core/0.7-groovy-2.0/jar/4de0b428de0c14b6eb6375d8174f71848cbfc1d7/spock-core-0.7-groovy-2.0.jar
Groovy location: file:~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/groovy-all-1.8.6.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>This seemed odd, as I was explicitly including version 2.2.1 of <a href="http://groovy.codehaus.org" target="_blank">Groovy</a> in my build.gradle script.  After a little digging on the internets, I discovered that <a href="http://gradle.org" target="_blank">Gradle</a> depends on
<a href="http://groovy.codehaus.org" target="_blank">Groovy</a> 1.8.6 and by using the <code>localGroovy()</code> or <code>gradleApi()</code> dependencies, there is no way to replace/override this.  Furthermore, its probably not a good idea to do so, as
<a href="http://gradle.org" target="_blank">Gradle</a> itself is partially written in <a href="http://groovy.codehaus.org" target="_blank">Groovy</a>.  Luckily, <a href="https://code.google.com/p/spock/" target="_blank">Spock</a> supports both <a href="http://groovy.codehaus.org" target="_blank">Groovy</a> 1.8.x and 2.x, so I simply changed my <a href="https://code.google.com/p/spock/" target="_blank">Spock</a> dependency to be compatible with <a href="http://groovy.codehaus.org" target="_blank">Groovy</a>
1.8.6.  I thought that I was out of the woods, but on my next attempt to run the tests, I ran into another issue.  The tests failed, complaining about a missing method exception:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint text language-text"><code>org.gradle.api.tasks.TaskExecutionException: Execution failed for task ':raml-generate'.
    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:69)
    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:46)
    at org.gradle.api.internal.tasks.execution.PostExecutionAnalysisTaskExecuter.execute(PostExecutionAnalysisTaskExecuter.java:35)
    at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:64)
    at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:58)
    at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:42)
    at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:52)
    at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:53)
    at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)
    at org.gradle.api.internal.AbstractTask.executeWithoutThrowingTaskFailure(AbstractTask.java:289)
    at org.gradle.api.internal.AbstractTask.execute(AbstractTask.java:284)
    at org.raml.jaxrs.codegen.gradle.CodeGeneratorTaskSpec.test the generation of JAX-RS annotated resources from a .raml file(CodeGeneratorTaskSpec.groovy:220)
Caused by: java.lang.NoSuchMethodError: org.yaml.snakeyaml.nodes.MappingNode.isMerged()Z
    at org.raml.parser.visitor.NodeVisitor.doVisitMappingNode(NodeVisitor.java:126)
    at org.raml.parser.visitor.NodeVisitor.visitDocument(NodeVisitor.java:209)
    at org.raml.parser.visitor.YamlValidationService.validate(YamlValidationService.java:64)
    at org.raml.parser.visitor.YamlValidationService.validate(YamlValidationService.java:95)
    at org.raml.parser.visitor.YamlValidationService.validate(YamlValidationService.java:76)
    at org.raml.jaxrs.codegen.core.Generator.run(Generator.java:110)
    at org.raml.jaxrs.codegen.gradle.CodeGeneratorTask.generate_closure1(CodeGeneratorTask.groovy:80)
    at groovy.lang.Closure.call(Closure.java:412)
    at groovy.lang.Closure.call(Closure.java:425)
    at org.raml.jaxrs.codegen.gradle.CodeGeneratorTask.generate(CodeGeneratorTask.groovy:79)
    at org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.java:63)
    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.doExecute(AnnotationProcessingTaskFactory.java:219)
    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.execute(AnnotationProcessingTaskFactory.java:212)
    at org.gradle.api.internal.project.taskfactory.AnnotationProcessingTaskFactory$StandardTaskAction.execute(AnnotationProcessingTaskFactory.java:201)
    at org.gradle.api.internal.AbstractTask$TaskActionWrapper.execute(AbstractTask.java:533)
    at org.gradle.api.internal.AbstractTask$TaskActionWrapper.execute(AbstractTask.java:516)
    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:80)
    at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:61)
    ... 11 more</code></pre>
</div>
</div>
<div class="paragraph">
<p>Well, that&#8217;s odd.  The <a href="http://raml.org" target="_blank">RAML</a> libraries include <code>org.yaml:snakeyaml:1.13</code> as a transitive dependency, which includes the proper version of <code>MappingNode</code>.  Furthermore, I was able to test my
plugin in a sample application and it works, so I figured something must be up with the "test" scope classpath in the <a href="http://gradle.org" target="_blank">Gradle</a> plugin project.  If we recall the list of dependencies above
(which I got by printing out the contents of the <code>configurations.testCompile</code> configuration in my build.gradle script), you can see that there is a reference to the <code>snakeyaml</code> dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint text language-text"><code>~/.gradle/wrapper/dists/gradle-1.11-bin/4h5v8877arc3jhuqbm3osbr7o7/gradle-1.11/lib/plugins/snakeyaml-1.6.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Somehow, this dependency is winning out over the transitively included dependency from the <a href="http://raml.org" target="_blank">RAML</a> dependency, eventhough when printing out the resloved dependency tree via the <a href="http://gradle.org" target="_blank">Gradle</a>
<code>dependencies</code> task, it shows only version 1.13.  Because there is no way (at least that I have found so far) to exclude the dependencies that are brought in by the <a href="http://gradle.org" target="_blank">Gradle</a> API, this means
that if you have a <a href="http://gradle.org" target="_blank">Gradle</a> plugin project that uses any of the dependencies that are also used by the <a href="http://gradle.org" target="_blank">Gradle</a> API, you are effectively stuck at the versions of those dependencies that match
what <a href="http://gradle.org" target="_blank">Gradle</a> currently depends on.  I have brought this issue up on the <a href="http://gradle.org" target="_blank">Gradle</a> forum and I noticed that a few other people have asked for a feature to allow for excluding dependencies from
the <a href="http://gradle.org" target="_blank">Gradle</a> API.  I will keep you posted on this issue and if I get an answer and/or resolution.</p>
</div>
</div>
</div></p>
                <p><a href="/blog/2014/04/15/gradle_api_dependencies.html#disqus_thread">Comments</a></p>

                <hr />

                <p>Older posts are available in the <a href="/blog/archive.html">archive</a>.</p>

            </div>
            <div id="push"></div>
        </div>

        <div id="footer">
              <div class="container">
                <p class="muted credit">&copy; 2014 | Mixed with <a href="http://getbootstrap.com/">Bootstrap v3.1.1</a> | Baked with <a href="http://jbake.org">JBake v2.3.0-SNAPSHOT</a> | Comments powered by <a href="http://disqus.com">Disqus</a></p>
              </div>
        </div>

        <!-- Le javascript
        ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="https://code.jquery.com/jquery.js" type="text/javascript"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="/blog/js/run_prettify.js" type="text/javascript"></script>
        <script src="/blog/js/github_activity.js" type="text/javascript"></script>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jdpearlin'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <script type="text/javascript">
              window.___gcfg = {lang: 'en'};

              (function() {
                var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
                po.src = 'https://apis.google.com/js/plusone.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
              })();
        </script>
        <script type="text/javascript">
            (function(d, s, id) {
                  var js, fjs = d.getElementsByTagName(s)[0];
                  if (d.getElementById(id)) return;
                  js = d.createElement(s); js.id = id;
                  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
                  fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <script src="//platform.linkedin.com/in.js" type="text/javascript"></script>
        <script type="text/javascript">
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-47885115-1', 'jdpgrailsdev.github.io');
          ga('send', 'pageview');
        </script>
    </body>
</html>