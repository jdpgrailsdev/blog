<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <title>The Flowers Are Still Standing</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="" />
        <meta name="author" content="Jonathan Pearlin" />
        <meta name="keywords" content="" />
        <meta name="generator" content="JBake" />

        <!-- Le styles -->
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
        <link href="/blog/css/asciidoctor.css" rel="stylesheet">
        <link href="/blog/css/base.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link href='http://fonts.googleapis.com/css?family=Droid+Sans' rel='stylesheet' type='text/css'>
		<link href='/blog/css/octicons.min.css' rel='stylesheet' type='text/css'>

        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
              <script src="/blog/js/html5shiv.js"></script>
        <![endif]-->

        <!-- Fav and touch icons -->
        <!--
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png" />
        -->
        <link rel="shortcut icon" href="/blog/favicon.ico" />
    </head>
    <body>
        <div id="wrap">
            <!-- Fixed navbar -->
            <div class="navbar navbar-default navbar-fixed-top" role="navigation">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/blog/index.html">Jonathan Pearlin's Blog</a>
                    </div>
                    <div class="navbar-collapse collapse">
                        <ul class="nav navbar-nav">
                            <li><a href="/blog/about.html">About</a></li>
                            <li><a href="/blog/resume.html">Résumé</a></li>
                            <li><a href="/blog/friends.html">Friends</a></li>
                            <li class="dropdown">
                                <a data-toggle="dropdown" href="#">Tags<b class="caret"></b></a>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a href="/blog/tags/gradle.html">Gradle</a></li>
                                    <li><a href="/blog/tags/grails.html">Grails</a></li>
                                    <li><a href="/blog/tags/groovy.html">Groovy</a></li>
                                    <li><a href="/blog/tags/java.html">Java</a></li>
                                    <li><a href="/blog/tags/maven.html">Maven</a></li>
                                    <li><a href="/blog/tags/spring.html">Spring</a></li>
                                    <li><a href="/blog/tags/zookeeper.html">ZooKeeper</a></li>
                                </ul>
                            </li>
                            <li><a href="/blog/feed.xml">Feed</a></li>
                        </ul>
                        <ul class="nav navbar-nav navbar-right">
                            <li><a href="https://github.com/jdpgrailsdev" target="_blank"><i class="fa fa-github"></i></a></li>
                            <li><a href="http://www.linkedin.com/pub/jonathan-pearlin/4/946/9a0" style="text-decoration:none;" target="_blank"><i class="fa fa-linkedin-square"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
			<div id="activity" class="pull-left">
	            <div class="panel panel-primary">
	                  <!-- Default panel contents -->
	                  <div class="panel-heading"><a target="_blank" href="http://github.com/jdpgrailsdev?tab=activity"><i class="fa fa-github"></i> My Recent GitHub Activity</a></div>
					  <div class="panel-body">
					      <i class='icon-spinner icon-spin icon-large'></i> Loading...
					  </div>
	                  <!-- List group -->
                      <ul class="list-group">
	                  </ul>
	            </div>
			</div>
            <div class="container">
                <div class="page-header">
                    <h1>The Flowers Are Still Standing</h1>
                </div>

                   <a href="/blog2014/07/01/eclipse_env_vars_mac_osx.html"><h1>Eclipse, Environment Variables and Mac OSX</h1></a>
                   <p>01 July 2014</p>
                <p><em>Tags: </em>
                <a href="/blog/tags/eclipse.html">eclipse</a>
        
                <a href="/blog/tags/mac.html">mac</a>
        </p>

                <div class="g-plusone" data-size="medium" data-href="http://jdpgrailsdev.github.io/blog2014/07/01/eclipse_env_vars_mac_osx.html"></div>
                <script type="IN/Share" data-url="http://jdpgrailsdev.github.io/blog2014/07/01/eclipse_env_vars_mac_osx.html" data-counter="right"></script>
                <div class="fb-like" data-href="http://jdpgrailsdev.github.io/blog2014/07/01/eclipse_env_vars_mac_osx.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

                   <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>I ran into an issue the other day when attempting to run a <a href="http://gradle.org" target="_blank">Gradle</a> build script that invokes a process from within Eclipse.  For whatever reason, Eclipse does not pick up
environment variables from the shell when launching on Mac OSX.  If you attempt to reference a command on your path from within Eclipse, you will most likely see
an error similar to this one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint"><code>java.io.IOException: Cannot run program "thrift": error=2, No such file or directory</code></pre>
</div>
</div>
<div class="paragraph">
<p>Just to prove that I was not crazy and the <code>thrift</code> binary was indeed present on my path, I ran the following command from a terminal window:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint"><code>~$ thrift -version
Thrift version 0.9.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>To correct this problem on Mac OSX, you can create a basic bash script to export the variables that you need (in my case, the binary was aleady included
on my PATH environment variable) and then launch Eclipse:</p>
</div>
<div class="listingblock">
<div class="title">eclipseLauncher.sh</div>
<div class="content">
<pre class="prettyprint"><code>#!/bin/bash
source ~/.profile
/Applications/eclipse/eclipse</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, create an <code>Automator</code> that can launch the new script.  To do so, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the dock in Mac OSX, open Applications &gt; Automator</p>
</li>
<li>
<p>Select "Application" from the document wizard.</p>
</li>
<li>
<p>Search for and select "Run Shell Script" from the "Actions" search box.</p>
</li>
<li>
<p>Enter the following into the text box in the "Run Shell Script" section:</p>
<div class="literalblock">
<div class="content">
<pre>/Applications/eclipse/eclipseLauncher.sh</pre>
</div>
</div>
</li>
<li>
<p>Select "as arguments" in the "Pass Input" selector.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can test the new script from the Automator application before saving by clicking on the "Run" button in the upper right-hand corner of the Automator window.
When you are ready, select "File &gt; Save&#8230;" to save the new application automator script.  I recommend saving it in <code>/Applications/eclipse</code>.  <strong>MAKE SURE THAT YOU DO
NOT OVERWRITE THE EXISTING "Eclipse" APPLICATION</strong>.</p>
</div>
<div class="paragraph">
<p>Next up, add it to the dock by launching it via the Applications menu.  You can also open the <code>/Applications/eclipse</code> folder in the Finder, select the new application and right-click select "Get Info" if you want to change the icon.
In the info window, click on the icon at the top of the window so that a blue halo appears around it.  In the finder window, select the original Eclipse application file and drag it over the icon in the info window to change the new application to use the Eclipse icon.</p>
</div>
</div>
</div></p>
                <p><a href="/blog2014/07/01/eclipse_env_vars_mac_osx.html#disqus_thread">Comments</a></p>
                   <a href="/blog2014/06/24/logback_grails.html"><h1>Grails and Logback Revisited</h1></a>
                   <p>24 June 2014</p>
                <p><em>Tags: </em>
                <a href="/blog/tags/grails.html">grails</a>
        
                <a href="/blog/tags/logback.html">logback</a>
        </p>

                <div class="g-plusone" data-size="medium" data-href="http://jdpgrailsdev.github.io/blog2014/06/24/logback_grails.html"></div>
                <script type="IN/Share" data-url="http://jdpgrailsdev.github.io/blog2014/06/24/logback_grails.html" data-counter="right"></script>
                <div class="fb-like" data-href="http://jdpgrailsdev.github.io/blog2014/06/24/logback_grails.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

                   <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a href="http://jonathanpearlin.com/2014/03/24/grails_logback.html" target="_blank">Previously</a>, I blogged about using <a href="http://logback.qos.ch/" target="_blank">Logback</a> with <a href="http://grails.org" target="_blank">Grails</a>.  While the contents of that post are mostly accurate, I have uncovered a few issues
with that approach, mostly related to the use of the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a>.  The <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a> is intended to only work the <code>logback</code> DSL in <code>grails-app/conf/*Config.groovy</code>.  If you attempt to use your own custom <code>logback.xml</code>
or <code>logback.groovy</code>, it is ignored, even though <a href="http://logback.qos.ch/" target="_blank">Logback</a> may report that it was loaded.  My suspicion is that the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a> plugin is re-initializing <a href="http://logback.qos.ch/" target="_blank">Logback</a> after the fact, thus erasing any configuration loaded
from the configuration files.  Additionally, the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a> depends on version 1.0.12 of <a href="http://logback.qos.ch/" target="_blank">Logback</a>, which is about 3 to 4 release behind the latest release.  I arrived at the conclusion that the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a> was interferring with
my configuration files by using the following <a href="http://logback.qos.ch/" target="_blank">Logback</a> configuration:</p>
</div>
<div class="listingblock">
<div class="title">logback.groovy</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>import static ch.qos.logback.classic.Level.ERROR
import static ch.qos.logback.classic.Level.INFO
import ch.qos.logback.classic.encoder.PatternLayoutEncoder
import ch.qos.logback.core.ConsoleAppender
import ch.qos.logback.core.rolling.FixedWindowRollingPolicy
import ch.qos.logback.core.rolling.RollingFileAppender
import ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy
import ch.qos.logback.core.status.OnConsoleStatusListener

def BASE_DIR = System.getProperty('catalina.base') ?: System.getProperty('user.dir')

statusListener OnConsoleStatusListener
jmxConfigurator('myapp:type=LoggerManager')

appender('STDOUT', ConsoleAppender) {
    encoder(PatternLayoutEncoder) {
        pattern = '%-50(%date{ISO8601} [%thread]) %-5level %logger{50} - %msg%n%rEx'
    }
}

logger('org.codehaus.groovy.grails', ERROR, ['STDOUT'], false)
logger('org.springframework', ERROR, ['STDOUT'], false)
logger('org.hibernate', ERROR, ['STDOUT'], false)
logger('net.sf.ehcache', ERROR, ['STDOUT'], false)
logger('grails.plugin', ERROR, ['STDOUT'], false)
logger('org.grails.plugin', ERROR, ['STDOUT'], false)
logger('grails.app', INFO, ['STDOUT'], false)

root(INFO, ['STDOUT'])</code></pre>
</div>
</div>
<div class="paragraph">
<p>When starting the application with this configuration, the only output reported by <a href="http://logback.qos.ch/" target="_blank">Logback</a> is the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint"><code>13:27:25,368 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@61b99295 - Added status listener of type [ch.qos.logback.core.status.OnConsoleStatusListener]
13:27:25,549 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@61b99295 - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender]
13:27:25,550 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@61b99295 - Naming appender as [STDOUT]</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is very strange, as <a href="http://logback.qos.ch/" target="_blank">Logback</a> was not reporting that any loggers were created or that those loggers have been associated with one or more appenders.  After some digging through
the <a href="http://logback.qos.ch/" target="_blank">Logback</a> <code>ch.qos.logback.classic.gaffer.ConfigurationDelegate</code> class, which handles the DSL from the above configuration, I noticed that the most recent version of <a href="http://logback.qos.ch/" target="_blank">Logback</a> (1.1.2)
has much better output during startup.  I decided to change my <a href="http://grails.org" target="_blank">Grails</a> application to explicitly depend on the latest <a href="http://logback.qos.ch/" target="_blank">Logback</a> version:</p>
</div>
<div class="listingblock">
<div class="title">BuildConfig.groovy</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>plugins {
    compile ':logback:0.3.1'
}

dependencies {
    compile 'ch.qos.logback:logback-core:1.1.2'
    compile 'ch.qos.logback:logback-classic:1.1.2'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After restarting the <a href="http://grails.org" target="_blank">Grails</a> application, I saw the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint"><code>13:32:36,412 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Added status listener of type [ch.qos.logback.core.status.OnConsoleStatusListener]
13:32:36,556 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender]
13:32:36,557 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Naming appender as [STDOUT]
13:32:36,981 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Setting level of logger [org.codehaus.groovy.grails] to ERROR
13:32:36,989 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Attaching appender named [STDOUT] to Logger[org.codehaus.groovy.grails]
13:32:37,070 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Setting level of logger [org.springframework] to ERROR
13:32:37,070 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Attaching appender named [STDOUT] to Logger[org.springframework]
13:32:37,071 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Setting level of logger [org.hibernate] to ERROR
13:32:37,071 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Attaching appender named [STDOUT] to Logger[org.hibernate]
13:32:37,071 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Setting level of logger [net.sf.ehcache] to ERROR
13:32:37,071 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Attaching appender named [STDOUT] to Logger[net.sf.ehcache]
13:32:37,072 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Setting level of logger [grails.plugin] to ERROR
13:32:37,072 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Attaching appender named [STDOUT] to Logger[grails.plugin]
13:32:37,072 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Setting level of logger [org.grails.plugin] to ERROR
13:32:37,072 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Attaching appender named [STDOUT] to Logger[org.grails.plugin]
13:32:37,073 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Setting level of logger [grails.app] to INFO
13:32:37,073 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Attaching appender named [STDOUT] to Logger[grails.app]
13:32:37,074 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Setting level of logger [ROOT] to INFO
13:32:37,074 |-INFO in ch.qos.logback.classic.gaffer.ConfigurationDelegate@55e6490 - Attaching appender named [STDOUT] to Logger[ROOT]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sweet.  <a href="http://logback.qos.ch/" target="_blank">Logback</a> appeared to be configured and working as expected.  After clicking around my application and not seeing anything log to the console, I became very suspicious that I had solved the problem simply
by updating the version of <a href="http://logback.qos.ch/" target="_blank">Logback</a> used by the application.  I decided to print out the appenders associated with one of the loggers to verify that the <code>ConfigurationDelegate</code> actually set things up properly:</p>
</div>
<div class="listingblock">
<div class="title">Bootstrap.groovy</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>def init = { servletContext -&gt;
    println "Appenders = ${LoggerFactory.getLogger('grails.app').aai.appenderList"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code above printed out an empty list.  After some head scratching, I determined that the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a> was somehow overwriting/replacing the <a href="http://logback.qos.ch/" target="_blank">Logback</a> configuration set up by the <code>logback.groovy</code> file.  I decided
to remove the dependency on the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a> from <code>grails-app/conf/BuildConfig.groovy</code> as I am not using the DSL from <code>grails-app/conf/*Config.groovy</code>. After removing the <a href="http://grails.org/plugin/logback" target="_blank">Grails Logback Plugin</a> entirely, everything worked as expected!</p>
</div>
</div>
</div></p>
                <p><a href="/blog2014/06/24/logback_grails.html#disqus_thread">Comments</a></p>
                   <a href="/blog2014/06/17/logback_tomcat_rolling_appender.html"><h1>A Tomcat Rolling File Appender with Logback</h1></a>
                   <p>17 June 2014</p>
                <p><em>Tags: </em>
                <a href="/blog/tags/logback.html">logback</a>
        
                <a href="/blog/tags/groovy.html">groovy</a>
        
                <a href="/blog/tags/tomcat.html">tomcat</a>
        </p>

                <div class="g-plusone" data-size="medium" data-href="http://jdpgrailsdev.github.io/blog2014/06/17/logback_tomcat_rolling_appender.html"></div>
                <script type="IN/Share" data-url="http://jdpgrailsdev.github.io/blog2014/06/17/logback_tomcat_rolling_appender.html" data-counter="right"></script>
                <div class="fb-like" data-href="http://jdpgrailsdev.github.io/blog2014/06/17/logback_tomcat_rolling_appender.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

                   <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Recently, I needed to add a <a href="http://logback.qos.ch/" target="_blank">Logback</a> configuration to an application that is deployed in <a href="http://tomcat.apache.org/" target="_blank">Apache Tomcat</a>.  I wanted to
ensure that my log files did not grow in an unbounded manner.  To protect against this, I decided to use the <code>RollingFileAppender</code> provided by <a href="http://logback.qos.ch/" target="_blank">Logback</a>.  That is an
obvious choice to solve this problem, but I wanted to ensure that when running the application in <a href="http://tomcat.apache.org/" target="_blank">Apache Tomcat</a>, the generated
log files end up in <code>${catalina.base}/logs</code> and when running locally via something like the <a href="http://tomcat.apache.org/maven-plugin-trunk/tomcat7-maven-plugin/" target="_blank">Maven Apache Tomcat Plugin</a>
it chose an appropriate output directory.  I arrive at the following <a href="http://groovy.codehaus.org/" target="_blank">Groovy</a>-based <a href="http://logback.qos.ch/" target="_blank">Logback</a> configuration file:</p>
</div>
<div class="listingblock">
<div class="title">logback.groovy</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>import static ch.qos.logback.classic.Level.INFO

import ch.qos.logback.classic.encoder.PatternLayoutEncoder
import ch.qos.logback.core.rolling.FixedWindowRollingPolicy
import ch.qos.logback.core.rolling.RollingFileAppender
import ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy
import ch.qos.logback.core.status.OnConsoleStatusListener

// Print out the Logback configuration information at startup.
statusListener OnConsoleStatusListener

def BASE_DIR = System.getProperty('catalina.base') ?: System.getProperty('user.dir')	<i class="conum" data-value="1"></i><b>(1)</b>

appender("WEBAPP", RollingFileAppender) {
    file = "${BASE_DIR}/logs/application.log"
    encoder(PatternLayoutEncoder) {
        pattern = "%-50(%date{ISO8601} [%thread]) %-5level %logger{50} - %msg%n%rEx"
    }
    triggeringPolicy(SizeBasedTriggeringPolicy) {
        maxFileSize = '10MB'
    }
    rollingPolicy(FixedWindowRollingPolicy) {
        fileNamePattern = "${BASE_DIR}/logs/application-%d{yyyyMMdd_hhmmss}.%i.gz"
        maxIndex = 10
    }
}

root(INFO, ["WEBAPP"])</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the <code>catalina.base</code> property is present and not blank, use it.  Otherwise, use the current user&#8217;s directory as the base for the log file.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The configuration above ensures that not only will the log files be rotated based on size, but that the files will be created in the appropriate location based
on the inspection of the <code>catalina.base</code> and <code>user.dir</code> system properties.  Because the configuration is written in <a href="http://groovy.codehaus.org/" target="_blank">Groovy</a>, we can
use any sort of logic we want to manipulate the <a href="http://logback.qos.ch/" target="_blank">Logback</a> configuration at runtime to ensure the proper setup for the logging infrastructure in our application.</p>
</div>
</div>
</div></p>
                <p><a href="/blog2014/06/17/logback_tomcat_rolling_appender.html#disqus_thread">Comments</a></p>
                   <a href="/blog2014/06/10/grails_stracetrace_log.html"><h1>Grails and stacktrace.log</h1></a>
                   <p>10 June 2014</p>
                <p><em>Tags: </em>
                <a href="/blog/tags/grails.html">grails</a>
        </p>

                <div class="g-plusone" data-size="medium" data-href="http://jdpgrailsdev.github.io/blog2014/06/10/grails_stracetrace_log.html"></div>
                <script type="IN/Share" data-url="http://jdpgrailsdev.github.io/blog2014/06/10/grails_stracetrace_log.html" data-counter="right"></script>
                <div class="fb-like" data-href="http://jdpgrailsdev.github.io/blog2014/06/10/grails_stracetrace_log.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div>

                   <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Out of the box, the <a href="http://grails.org" target="_blank">Grails</a> framework programmatically configures a file-based logging appender that produces a log file named <code>stacktrace.log</code>.  This log contains any errors generated by the <a href="http://grails.org" target="_blank">Grails</a> application.  One of its problems
is that this appender does not use a rolling file appender and therefore can grow without bound.  Typically, I configure my own applications to use a rolling file appender
which makes the <code>stacktrace.log</code> file superfluous, as all errors are also logged to my custom appender.  You can remove this appender at runtime by adding some magic to your application&#8217;s <code>grails-app/conf/Bootstrap.groovy</code> file:</p>
</div>
<div class="listingblock">
<div class="title">Boostrap.groovy</div>
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>import org.slf4j.LoggerFactory

import ch.qos.logback.classic.LoggerContext
import ch.qos.logback.core.util.StatusPrinter

class BootStrap {

    def init = { servletContext -&gt;
        // Remove the Grails stack trace log appender, as it does not use a rolling appender.
        removeStackTraceLogAppender()
    }

    def destroy = {
    }

    /**
     * Removes the 'stacktraceLog' appender added by Grails.  This appender does NOT use a
     * rolling file appender and can grow to astronomical sizes if left unattended.  Removing
     * this log file does not remove any data, as the errors logged to it also get logged
     * to the console appender.
     */
    private def removeStackTraceLogAppender() {
        def logger = LoggerFactory.getLogger('StackTrace')
        if(logger) {
            def stackTraceAppender = logger.getAppender('stacktraceLog')
            if(stackTraceAppender) {
                if(logger.detachAppender(stackTraceAppender)) {
                    println "Grails 'stacktraceLog' log appender removed from configuration."
                }
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code above asks the <a href="http://www.slf4j.org/" target="blank">SLF4J</a> API for the <code>StackTrace</code> logger, which is created programmatically by the <a href="http://grails.org" target="_blank">Grails</a> framework.  From that logger, the <code>stacktraceLog</code> appender
is retrieved and detached, to ensure that any information sent to the <code>StackTrace</code> logger does not get appended to the <code>stacktrace.log</code> file.  This helps to prevent this log file from growing in an unbounded manner.</p>
</div>
</div>
</div></p>
                <p><a href="/blog2014/06/10/grails_stracetrace_log.html#disqus_thread">Comments</a></p>

                <hr />

                <p>Older posts are available in the <a href="/blog/archive.html">archive</a>.</p>

            </div>
            <div id="push"></div>
        </div>

        <div id="footer">
              <div class="container">
                <p class="muted credit">&copy; 2014 | Mixed with <a href="http://getbootstrap.com/">Bootstrap v3.1.1</a> | Baked with <a href="http://jbake.org">JBake v2.3.0</a> | Comments powered by <a href="http://disqus.com">Disqus</a></p>
              </div>
        </div>

        <!-- Le javascript
        ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="https://code.jquery.com/jquery.js" type="text/javascript"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="/blog/js/run_prettify.js" type="text/javascript"></script>
        <script src="/blog/js/github_activity.js" type="text/javascript"></script>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jdpearlin'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <script type="text/javascript">
              window.___gcfg = {lang: 'en'};

              (function() {
                var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
                po.src = 'https://apis.google.com/js/plusone.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
              })();
        </script>
        <script type="text/javascript">
            (function(d, s, id) {
                  var js, fjs = d.getElementsByTagName(s)[0];
                  if (d.getElementById(id)) return;
                  js = d.createElement(s); js.id = id;
                  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
                  fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <script src="//platform.linkedin.com/in.js" type="text/javascript"></script>
        <script type="text/javascript">
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-47885115-1', 'jdpgrailsdev.github.io');
          ga('send', 'pageview');
        </script>
    </body>
</html>